<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>회원 정보 관리</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <style>
    .filter-option {
      cursor: pointer;
      padding: 10px 20px;
      margin-right: 10px;
      border-radius: 5px;
      background-color: #f8f9fa;
      color: #495057;
      transition: background-color 0.3s;
    }

    .filter-option:hover {
      background-color: #6c757d;
      color: white;
    }

    .filter-option.active {
      background-color: #007bff;
      color: white;
    }

    .user-stats {
      display: block;
      text-align: left;
      margin-bottom: 15px;
      font-size: 15px;
    }
    
    .user-stats span {
      display: inline-block;
      margin-right: 15px;
    }

    .user-stats span span{
      margin-left: 10px;
    }

    .user-stats span:not(:last-child)::after {
      content: '|';
      margin-left: 10px;
      color: #6c757d;
    }
  </style>
</head>
<body>

<div class="container mt-5">
  <h3 class="font-weight-bold mb-4">회원 정보 관리</h3>
  <P>가입된 회원 정보를 확인하거나 수정할 수 있는 페이지입니다.</P>

  <!-- 등급 필터 바 -->
  <div class="d-flex justify-content-start mb-3">
    <span class="filter-option active" onclick="filterUsers('전체')">전체 <span id="total-count">0</span></span>
    <span class="filter-option" onclick="filterUsers('일반회원')">일반회원 <span id="general-count">0</span></span>
    <span class="filter-option" onclick="filterUsers('실버회원')">실버회원 <span id="silver-count">0</span></span>
    <span class="filter-option" onclick="filterUsers('골드회원')">골드회원 <span id="gold-count">0</span></span>
    <span class="filter-option" onclick="filterUsers('VIP회원')">VIP회원 <span id="vip-count">0</span></span>
    <span class="filter-option" onclick="filterUsers('관리자')">관리자 <span id="admin-count">0</span></span>
  </div>
  <hr> <!-- 구분선 추가 -->

  <!-- 검색 섹션 -->
  <div class="search-section mb-4 d-flex align-items-center">
    <select class="form-control mr-2" style="width: 150px;" id="search-type">
      <option value="email">아이디</option>
      <option value="name">이름</option>
    </select>
    <input type="text" class="form-control mr-2" placeholder="검색어를 입력하세요" style="width: 300px;" id="search-input">
    <button class="btn btn-secondary" onclick="searchUsers()">조회</button>
  </div>

  <!-- 회원 목록 테이블 -->
  <table class="table table-bordered text-center">
    <thead class="thead-light">
      <tr>
        <th>가입순서</th>
        <th>아이디(이메일형식)</th>
        <th>이름</th>
        <th>전화번호</th>
        <th>주소</th>
        <th>회원 등급</th>
        <th>수정</th>
      </tr>
    </thead>
    <tbody id="user-list">
      <!-- 회원 목록 (동적으로 추가됨) -->
    </tbody>
  </table>

  <!-- 페이지네이션 -->
  <nav aria-label="Page navigation" class="mt-4">
    <ul class="pagination justify-content-center" id="pagination">
      <!-- 페이지 번호가 여기에 동적으로 추가됩니다. -->
    </ul>
  </nav>
</div>

<!-- 모달 창 -->
<div class="modal fade" id="userDetailModal" tabindex="-1" role="dialog" aria-labelledby="userDetailModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="userDetailModalLabel">회원 정보 관리</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p><strong>가입순서 :</strong> <span id="modal-request-signup"></span></p>
        <p><strong>아이디 :</strong> <span id="modal-user-id"></span></p>
        <p><strong>이름 :</strong> <span id="modal-user-name"></span></p>
        <p><strong>전화번호 :</strong> <span id="modal-phone"></span></p>
        <p><strong>주소 :</strong> <span id="modal-address"></span></p>
        <p><strong>회원 등급 :</strong>
          <select class="form-control d-inline-block" id="modal-user-level" style="width: 150px;">
            <option>일반회원</option>
            <option>실버회원</option>
            <option>골드회원</option>
            <option>VIP회원</option>
            <option>관리자</option>
          </select>
        </p>
        <div class="d-flex mt-3">
          <button class="btn btn-secondary mr-2" data-dismiss="modal">취소</button>
          <button class="btn btn-primary" onclick="saveLevel()">수정하기</button>
        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

<script>
  let currentUserId;
  const users = [
    { email: 'user1@example.com', name: '홍길동1', level: '일반회원', signupOrder: 1, phone: '010-1111-2222', address: '서울시 강남구' },
    { email: 'user2@example.com', name: '홍길동2', level: '실버회원', signupOrder: 2, phone: '010-3333-4444', address: '서울시 종로구' },
    { email: 'user3@example.com', name: '홍길동3', level: 'VIP회원', signupOrder: 3, phone: '010-5555-6666', address: '서울시 중구' },
    { email: 'user4@example.com', name: '홍길동4', level: '일반회원', signupOrder: 4, phone: '010-7777-8888', address: '서울시 송파구' },
    { email: 'user5@example.com', name: '홍길동5', level: '골드회원', signupOrder: 5, phone: '010-9999-0000', address: '서울시 구로구' },
    { email: 'user6@example.com', name: '홍길동6', level: '일반회원', signupOrder: 6, phone: '010-1234-5678', address: '서울시 양천구' },
    { email: 'admin1@example.com', name: '관리자1', level: '관리자', signupOrder: 7, phone: '010-2345-6789', address: '서울시 성동구' },
    { email: 'admin2@example.com', name: '관리자2', level: '관리자', signupOrder: 8, phone: '010-3456-7890', address: '서울시 강동구' },
    { email: 'user9@example.com', name: '홍길동9', level: '일반회원', signupOrder: 9, phone: '010-4567-8901', address: '서울시 서초구' }
  ];

  function filterUsers(level) {
    // 필터된 사용자 리스트
    const filteredUsers = level === '전체' ? users : users.filter(user => user.level === level);

    // 필터링된 사용자 목록 업데이트
    const userListElement = document.getElementById('user-list');
    userListElement.innerHTML = ''; // 기존 목록 제거

    filteredUsers.forEach(user => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${user.signupOrder}</td>
        <td>${user.email}</td>
        <td>${user.name}</td>
        <td>${user.phone}</td>
        <td>${user.address}</td>
        <td>${user.level}</td>
        <td><button class="btn btn-primary" onclick="openEditModal(${user.signupOrder})">상세</button></td>
      `;
      userListElement.appendChild(tr);
    });

    updateFilterCounts(level);

    // 필터 버튼의 active 클래스 처리
    const filterButtons = document.querySelectorAll('.filter-option');
    filterButtons.forEach(button => {
      button.classList.remove('active');  // 기존 active 클래스 제거
    });

    // 클릭한 버튼에 active 클래스 추가
    const activeButton = Array.from(filterButtons).find(button => button.textContent.includes(level));
    if (activeButton) {
      activeButton.classList.add('active');
    }
  }

  function updateFilterCounts(level) {
    const totalCount = users.length;
    const generalCount = users.filter(user => user.level === '일반회원').length;
    const silverCount = users.filter(user => user.level === '실버회원').length;
    const goldCount = users.filter(user => user.level === '골드회원').length;
    const vipCount = users.filter(user => user.level === 'VIP회원').length;
    const adminCount = users.filter(user => user.level === '관리자').length;

    document.getElementById('total-count').textContent = `(${totalCount}명)`;
    document.getElementById('general-count').textContent = `(${generalCount}명)`;
    document.getElementById('silver-count').textContent = `(${silverCount}명)`;
    document.getElementById('gold-count').textContent = `(${goldCount}명)`;
    document.getElementById('vip-count').textContent = `(${vipCount}명)`;
    document.getElementById('admin-count').textContent = `(${adminCount}명)`;
  }

  function openEditModal(signupOrder) {
    currentUserId = signupOrder;
    const user = users.find(user => user.signupOrder === signupOrder);

    // 모달에 사용자 정보 표시
    document.getElementById('modal-request-signup').textContent = user.signupOrder;
    document.getElementById('modal-user-id').textContent = user.email;
    document.getElementById('modal-user-name').textContent = user.name;
    document.getElementById('modal-phone').textContent = user.phone;
    document.getElementById('modal-address').textContent = user.address;
    document.getElementById('modal-user-level').value = user.level;

    // 모달 열기
    $('#userDetailModal').modal('show');
  }

  function saveLevel() {
    const user = users.find(user => user.signupOrder === currentUserId);
    const newLevel = document.getElementById('modal-user-level').value;

    user.level = newLevel;
    filterUsers(document.querySelector('.filter-option.active').textContent);
    $('#userDetailModal').modal('hide');
  }

  function searchUsers() {
    const searchType = document.getElementById('search-type').value;
    const searchText = document.getElementById('search-input').value.trim().toLowerCase();

    const filteredUsers = users.filter(user => {
      return user[searchType].toLowerCase().includes(searchText);
    });

    // 필터링된 사용자 목록 업데이트
    const userListElement = document.getElementById('user-list');
    userListElement.innerHTML = ''; // 기존 목록 제거

    filteredUsers.forEach(user => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${user.signupOrder}</td>
        <td>${user.email}</td>
        <td>${user.name}</td>
        <td>${user.phone}</td>
        <td>${user.address}</td>
        <td>${user.level}</td>
        <td><button class="btn btn-primary" onclick="openEditModal(${user.signupOrder})">수정</button></td>
      `;
      userListElement.appendChild(tr);
    });
  }

  // 페이지 로드 시, 초기화
  window.onload = () => {
    filterUsers('전체');
  };
</script>

</body>
</html>
